
async function getdatabaseJSON(){return fetch("/database_metadata.json").then(e=>e.json())}function isdatabaseConforming(e,t){for(const[n,s]of e)if(n.endsWith("Count")){let e,a;[e,a]=s.split("-").map(Number),void 0!==a||isNaN(e)||(a=e);const o=Number(t[n]);if(!(e<=o&&o<=a))return!1}else if(t[n]instanceof Array){if(!s.split(",").some(e=>new Set(t[n]).has(e)))return!1}else if("search"===n){let e=e=>["title","author","summary"].map(n=>t[n]&&-1!==String(t[n]).toLowerCase().indexOf(e.toLowerCase())).some(Boolean);if(!s.split(" ").every(e))return!1}else if(t[n]!==s&&t[n]!==("true"===s))return!1;return!0}async function getFiltereddatabase(){const e=new URLSearchParams(location.search);return getdatabaseJSON().then(t=>t.filter(t=>isdatabaseConforming(e,t)))}async function populatePostGrid(e){const t=$("post-grid");t.innerHTML="";const n=Number((location.pathname.match(/page\/([0-9]+)/)||["page/1","1"])[1]),s=18*(n-1),a=e.slice(s,s+18);if(0===e.length)$("showing-n-results").innerText="No results found.";else if(s<e.length)$("showing-n-results").innerText=`Showing ${s+1} to ${Math.min(s+18,e.length)} of ${e.length} results found.`;else{$("showing-n-results").innerText=`Showing 0 to 0 of ${e.length} results found.`;const t=Math.ceil(e.length/18);$("showing-n-results").innerText+=1===t?` There is only 1 page for this search, not ${n}.`:` There are only ${t} pages for this search, not ${n}.`}syncPaginationButtons();for(const e of a)t.innerHTML+=card(e,e.url)}const pageRegExp=new RegExp("/page/[0-9]+");("/"===location.pathname||pageRegExp.test(location.pathname))&&getFiltereddatabase().then(e=>populatePostGrid(e));

